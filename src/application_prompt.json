
{
  "appName": "Indian Community Chat App (USA)",
  "appDescription": "A mobile-first chat application designed to connect the Indian community within different states in the USA. It features state-specific public chat rooms, private messaging, and dedicated pages for community needs and offers.",
  "techStack": [
    "Next.js (App Router)",
    "React",
    "TypeScript",
    "Tailwind CSS",
    "ShadCN UI",
    "Firebase (Firestore, Authentication, Storage)"
  ],
  "coreFeatures": [
    {
      "feature": "Authentication",
      "description": "User registration and login via email and password. Session persistence is handled by Firebase Auth. Includes password reset functionality."
    },
    {
      "feature": "User Profiles",
      "description": "Users have profiles with first name, last name, username, email, phone, city, state, and a profile picture. Profiles are editable."
    },
    {
      "feature": "Public Chat",
      "description": "State-specific public group chat rooms (e.g., 'california', 'texas'). Users join based on their profile's state. Supports text messages."
    },
    {
      "feature": "Private Chat",
      "description": "Users can initiate one-on-one private chats with other users. Private chat history is accessible from a dedicated 'Personal Chats' screen."
    },
    {
      "feature": "Requirements Page",
      "description": "A dedicated page that displays community needs. Users can manually post new requirements (e.g., 'Jobs', 'Housing') through a form. They can also filter requirements by category. This page serves as a community needs board."
    },
    {
      "feature": "Coupons & Offers Page",
      "description": "A page displaying special deals and offers for the community. Admins can add, edit, and delete offers. Non-admin users see a CTA to contact an admin to post an offer."
    },
    {
      "feature": "Admin Dashboard",
      "description": "A protected page for administrators. It shows charts and key metrics for community requirements and offers, allowing admins to analyze activity at a glance."
    },
    {
      "feature": "Navigation",
      "description": "A mobile-friendly bottom navigation bar provides easy access to Chat, Requirements, Offers, and Profile. An Admin link appears for authorized users."
    }
  ],
  "dataModels": {
    "firestore": [
      {
        "collection": "users",
        "documentId": "{userId}",
        "schema": {
          "uid": "string",
          "firstName": "string",
          "lastName": "string",
          "username": "string (lowercase)",
          "email": "string (lowercase)",
          "phone": "string (optional)",
          "state": "string (optional, e.g., 'california')",
          "city": "string (optional)",
          "avatar": "string (URL to image, optional)",
          "isAdmin": "boolean"
        },
        "subcollections": [
          {
            "collection": "personalChats",
            "documentId": "{otherUserId}",
            "schema": {
              "roomId": "string",
              "withUser": {
                "uid": "string",
                "username": "string",
                "avatar": "string"
              },
              "lastMessage": "string (optional)",
              "lastMessageTimestamp": "timestamp (optional)",
              "lastMessageSenderId": "string (optional)",
              "unreadCount": "number (optional)"
            }
          }
        ]
      },
      {
        "collection": "chats",
        "documentId": "{roomId}",
        "description": "Room ID is the state name for public chats (e.g., 'hawaii') or a composite ID ('uid1_uid2') for private chats.",
        "schema": {
          "lastMessage": "string (optional)",
          "lastMessageSenderId": "string (optional)",
          "lastMessageTimestamp": "timestamp (optional)",
          "users": "array<string> (for private chats)",
          "isPersonal": "boolean (for private chats)"
        },
        "subcollections": [
          {
            "collection": "messages",
            "documentId": "{messageId}",
            "schema": {
              "user": {
                "id": "string",
                "name": "string",
                "avatar": "string"
              },
              "text": "string (optional)",
              "timestamp": "timestamp",
              "isDeleted": "boolean (optional)"
            }
          }
        ]
      },
      {
        "collection": "requirements",
        "documentId": "{requirementId}",
        "schema": {
          "user": {
            "id": "string",
            "name": "string",
            "avatar": "string"
          },
          "text": "string",
          "state": "string",
          "timestamp": "timestamp",
          "category": "string (e.g., 'Jobs', 'Housing')",
          "title": "string",
          "startDate": "string (yyyy-MM-dd, optional)",
          "expireDate": "string (yyyy-MM-dd, optional)"
        }
      },
      {
        "collection": "offers",
        "documentId": "{offerId}",
        "schema": {
          "title": "string",
          "description": "string",
          "images": "array<string> (URLs)",
          "code": "string (optional)",
          "validUntil": "string (yyyy-MM-dd, optional)",
          "type": "string (e.g., 'Discount', 'Deal', optional)",
          "states": "array<string> (list of state values, e.g., ['california', 'texas'], or ['all'])"
        }
      }
    ]
  },
  "aiFunctionality": {
    "genkitFlows": []
  },
  "securityRules": {
    "file": "firestore.rules",
    "description": "Defines access control for the Firestore database.",
    "rules": [
      {
        "path": "/users/{userId}",
        "permissions": {
          "read": "Allow if user is authenticated.",
          "write": "Allow only if the user is modifying their own document (request.auth.uid == userId)."
        }
      },
      {
        "path": "/chats/{roomId}",
        "permissions": {
            "read": "Allow if authenticated and it is a public chat (roomId has no '_') or if the user is part of the private chat (their uid is in the roomId).",
            "write": "Allow if authenticated."
        }
      },
      {
        "path": "/chats/{roomId}/messages/{messageId}",
        "permissions": {
          "read": "Allow if authenticated and it is a public chat (roomId has no '_') or if the user is part of the private chat (their uid is in the roomId).",
          "write": "Allow if authenticated and the message belongs to them."
        }
      },
      {
        "path": "/requirements/{requirementId}",
        "permissions": {
          "read": "Allow if user is authenticated.",
          "create": "Allow if user is authenticated.",
          "update": "Allow if user is an admin or if the requirement belongs to the user.",
          "delete": "Allow if user is an admin or if the requirement belongs to the user."
        }
      },
      {
        "path": "/offers/{offerId}",
        "permissions": {
          "read": "Allow if user is authenticated.",
          "write": "Allow if user is an admin."
        }
      }
    ]
  }
}
